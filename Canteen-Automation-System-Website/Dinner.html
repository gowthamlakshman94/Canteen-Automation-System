<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dinner - IIT Patna Canteen</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="order.css" type="text/css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script>
  (function(){
    const API_BASE = 'http://localhost:3000'; // adjust if different
    const CATEGORY = 'Dinner'; // this page's category

    async function loadMenu() {
      try {
        const res = await fetch(`${API_BASE}/api/menu?category=${encodeURIComponent(CATEGORY)}`);
        const json = await res.json();
        if (!json.success) { console.error('Menu fetch failed', json); return; }
        const container = document.getElementById('menuContainer');
        container.innerHTML = '';
        json.data.forEach(item => {
          const col = document.createElement('div'); col.className = 'col-sm-6 col-md-3';
          const thumb = document.createElement('div'); thumb.className = 'thumbnail'; thumb.style.textAlign='center';
          const img = document.createElement('img'); img.className='item-image'; img.style.width='100%'; img.style.height='170px'; img.style.objectFit='cover';
          img.src = item.image_url ? (API_BASE + item.image_url) : 'placeholder.jpg';
          img.alt = item.name;
          const caption = document.createElement('div'); caption.className='caption';
          const h4 = document.createElement('h4'); h4.className='item-title'; h4.textContent = item.name;
          const p = document.createElement('p'); p.className='item-price'; p.innerHTML = '&#8377; ' + parseFloat(item.price).toFixed(2);
          const addWrap = document.createElement('div'); addWrap.className='addToCartbutton';
          const btn = document.createElement('button'); btn.className='btn btn-primary btn-block add-to-cart'; btn.textContent='ADD TO CART';
          btn.dataset.id = item.id; btn.dataset.name = item.name; btn.dataset.price = item.price; btn.dataset.image = img.src;
          btn.addEventListener('click', function(){
            const itemData = { id: btn.dataset.id, name: btn.dataset.name, price: parseFloat(btn.dataset.price), image: btn.dataset.image, quantity: 1 };
            if (typeof window.addItemToCart === 'function') { window.addItemToCart(itemData); return; }
            window.dispatchEvent(new CustomEvent('canteen:addToCart', { detail: itemData }));
          });
          addWrap.appendChild(btn);
          caption.appendChild(h4); caption.appendChild(p); caption.appendChild(addWrap);
          thumb.appendChild(img); thumb.appendChild(caption); col.appendChild(thumb); container.appendChild(col);
        });
      } catch (e) { console.error('Menu load error', e); }
    }
    document.addEventListener('DOMContentLoaded', loadMenu);
  })();
  </script>
</head>
<body>
  <!-- copy your navbar / header here -->
  <nav class="navbar navbar-inverse navbar-fixed-top"> ... </nav>

  <div class="container" style="margin-top:90px;">
    <div class="jumbotron" style="text-align:center;border-radius:15px;">
      <h1>Breakfast Menu</h1>
      <p>Start your day right</p>
    </div>

    <div class="row" id="menuContainer"></div>

    <!-- CART SECTION (same as before) -->
    <div class="jumbotron" style="background-image: url('SEPM 123.jpg'); text-align: center; border-radius: 15px;">
      <section class="container content-section"> ... same cart markup ... </section>
    </div>
  </div>

  <footer> ... </footer>

  <script src="cart.js"></script>
</body>
</html>
